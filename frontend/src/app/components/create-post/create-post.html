<div class="modal-overlay" (click)="close()">
    <div class="modal-container" (click)="$event.stopPropagation()">
        <!-- Header -->
        <div class="modal-header">
            <h2 class="modal-title">Create Post</h2>
            <button class="modal-close-btn" (click)="close()">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>

        <!-- Content -->
        <div class="modal-content">
            <form class="modal-form">
                <!-- Title Input -->
                <div class="form-group">
                    <input [(ngModel)]="title" name="title" type="text" class="input-field title-input"
                        placeholder="Title of your post..." />
                </div>

                <!-- Content Textarea -->
                <div class="form-group">
                    <textarea [(ngModel)]="content" name="content" class="textarea-field content-textarea"
                        placeholder="What do you want to share today?"></textarea>
                </div>

                <!-- Media Upload Input -->
                <div class="form-group">
                    <label class="form-label">
                        <span class="material-symbols-outlined">image</span>
                        Add Images or Videos (optional)
                    </label>
                    <div class="file-upload-wrapper">
                        <input type="file" id="mediaFile" #fileInput accept="image/*,video/*" multiple
                            (change)="onFileSelected($event)" class="file-input" />
                        <label for="mediaFile" class="file-upload-btn">
                            <span class="material-symbols-outlined">upload</span>
                            Choose Files
                        </label>
                        <span class="file-name" *ngIf="selectedFileNames.length > 0">{{ selectedFileNames.length }}
                            file(s) selected</span>
                    </div>
                    <div
                        style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.25rem; font-style: italic;">
                        Hold Ctrl (Windows) or Cmd (Mac) to select multiple files.
                    </div>
                </div>

                <!-- Media Preview Grid -->
                <div class="media-preview-grid" *ngIf="imageUrls.length > 0">
                    <div class="preview-item" *ngFor="let url of imageUrls; let i = index">
                        <button type="button" class="remove-media-item-btn" (click)="removeMedia(i)">
                            <span class="material-symbols-outlined">close</span>
                        </button>

                        <!-- Video Preview -->
                        <div *ngIf="isVideo(url)" class="video-preview-item">
                            <video controls class="preview-video-thumb">
                                <source [src]="url" type="video/mp4">
                            </video>
                        </div>

                        <!-- Image Preview -->
                        <div *ngIf="!isVideo(url)" class="image-preview-item">
                            <img [src]="url" alt="Preview" class="preview-image-thumb" />
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <!-- Footer -->
        <div class="modal-footer">
            <button class="btn btn-secondary" (click)="close()">
                Cancel
            </button>
            <button class="btn btn-primary" [disabled]="!title || !content" (click)="createPost()">
                <span>Publish</span>
                <span class="material-symbols-outlined icon-small">send</span>
            </button>
        </div>
    </div>
</div>