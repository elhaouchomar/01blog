<div class="page-container">
    <app-navbar></app-navbar>

    <div class="content-wrapper">
        <!-- Sidebar -->
        <app-sidebar class="sidebar"></app-sidebar>

        <!-- Main Feed -->
        <main class="main-feed">
            <!-- Banned User Banner -->
            <div class="banned-banner" *ngIf="dataService.currentUser()?.banned">
                <div class="banner-content">
                    <span class="material-symbols-outlined">gavel</span>
                    <div class="banner-text">
                        <h3>Your account is restricted</h3>
                        <p>You have been banned by an administrator and cannot create posts or interact with others.</p>
                    </div>
                </div>
            </div>

            <!-- Premium Create Post Widget -->
            <div class="create-post-card" *ngIf="dataService.currentUser() && !dataService.currentUser()?.banned">
                <div class="widget-main">
                    <div class="user-avatar-premium"
                        [style.background-image]="'url(' + (dataService.currentUser()?.avatar || 'assets/default-avatar.png') + ')'">
                    </div>
                    <button class="widget-trigger-btn" (click)="modalService.open('create-post')">
                        <span class="placeholder-text">Share what you've learned today...</span>
                        <span class="material-symbols-outlined">edit_square</span>
                    </button>
                </div>
                <div class="widget-actions-grid">
                    <button class="action-item" (click)="modalService.open('create-post', {tab: 'media'})">
                        <div class="action-icon-bg media">
                            <span class="material-symbols-outlined">image</span>
                        </div>
                        <span class="action-label">Media</span>
                    </button>
                    <button class="action-item">
                        <div class="action-icon-bg event">
                            <span class="material-symbols-outlined">calendar_today</span>
                        </div>
                        <span class="action-label">Event</span>
                    </button>
                    <button class="action-item">
                        <div class="action-icon-bg article">
                            <span class="material-symbols-outlined">article</span>
                        </div>
                        <span class="action-label">Article</span>
                    </button>
                </div>
            </div>

            <!-- Posts List -->
            <div class="post-list">
                <div class="empty-state" *ngIf="!isLoading() && posts.length === 0"
                    style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                    No posts yet. Be the first to share something!
                </div>

                <app-post-card *ngFor="let post of posts" [post]="post"></app-post-card>

                <!-- Infinite Scroll Loading Indicator -->
                <div class="infinite-scroll-status" *ngIf="isFetchingMore()" style="text-align: center; padding: 2rem;">
                    <div class="spinner-border text-primary shadow-sm" role="status">
                        <span class="visually-hidden">Loading more...</span>
                    </div>
                </div>

                <div class="empty-state-premium" *ngIf="!isMoreAvailable() && posts.length > 0"
                    style="text-align: center; padding: 3rem; color: var(--text-secondary);">
                    <span class="material-symbols-outlined fs-1 mb-2">auto_awesome</span>
                    <p class="fw-bold">You're all caught up!</p>
                </div>
            </div>
        </main>

        <!-- Right Sidebar (Suggestions) -->
        <app-right-sidebar class="sidebar"></app-right-sidebar>
    </div>
</div>