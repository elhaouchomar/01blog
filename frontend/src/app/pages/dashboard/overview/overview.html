<div class="overview-container">
    <app-db-page-header title="Platform Overview" subtitle="Quick glimpse into the current state of the application."
        titleIcon="dashboard" iconColor="var(--primary)">
    </app-db-page-header>

    <!-- Stats Grid -->
    <div class="stats-grid" *ngIf="dataService.dashboardStats() as stats">
        <div class="stat-card users">
            <div class="stat-main">
                <div class="stat-info">
                    <p class="stat-label">Total Users</p>
                    <h3 class="stat-value">{{ stats.totalUsers | number }}</h3>
                </div>
                <div class="stat-icon-wrapper">
                    <span class="material-symbols-outlined">group</span>
                </div>
            </div>
            <div class="stat-footer">
                <span class="stat-trend positive">
                    <span class="material-symbols-outlined">trending_up</span>
                    <span>12% this month</span>
                </span>
            </div>
        </div>

        <div class="stat-card posts">
            <div class="stat-main">
                <div class="stat-info">
                    <p class="stat-label">Total Posts</p>
                    <h3 class="stat-value">{{ stats.totalPosts | number }}</h3>
                </div>
                <div class="stat-icon-wrapper">
                    <span class="material-symbols-outlined">article</span>
                </div>
            </div>
            <div class="stat-footer">
                <span class="stat-trend positive">
                    <span class="material-symbols-outlined">trending_up</span>
                    <span>5% this week</span>
                </span>
            </div>
        </div>

        <div class="stat-card reports warning">
            <div class="stat-main">
                <div class="stat-info">
                    <p class="stat-label">Active Reports</p>
                    <h3 class="stat-value">{{ stats.pendingReports | number }}</h3>
                </div>
                <div class="stat-icon-wrapper">
                    <span class="material-symbols-outlined">flag</span>
                </div>
            </div>
            <div class="stat-footer">
                <span class="stat-trend" [class.negative]="stats.pendingReports > 0">
                    <span class="material-symbols-outlined">{{ stats.pendingReports > 0 ? 'priority_high' :
                        'check_circle' }}</span>
                    <span>{{ stats.pendingReports > 0 ? 'Requires attention' : 'All resolved' }}</span>
                </span>
            </div>
        </div>

        <div class="stat-card banned danger">
            <div class="stat-main">
                <div class="stat-info">
                    <p class="stat-label">Banned Users</p>
                    <h3 class="stat-value">{{ stats.bannedUsers | number }}</h3>
                </div>
                <div class="stat-icon-wrapper">
                    <span class="material-symbols-outlined">block</span>
                </div>
            </div>
            <div class="stat-footer">
                <span class="stat-trend">
                    <span class="material-symbols-outlined">history</span>
                    <span>Last 30 days</span>
                </span>
            </div>
        </div>
    </div>

    <div class="feedback-grid" *ngIf="dataService.dashboardStats() as stats">
        <div class="feedback-item" *ngIf="stats.totalUsers === 0">
            <app-db-feedback type="empty" icon="group_off" iconColor="var(--primary)" title="No users"
                message="No users found yet.">
            </app-db-feedback>
        </div>
        <div class="feedback-item" *ngIf="stats.totalPosts === 0">
            <app-db-feedback type="empty" icon="article" iconColor="var(--success)" title="No posts"
                message="No posts found yet.">
            </app-db-feedback>
        </div>
    </div>

    <div class="dashboard-grid">
        <!-- Activity Chart Placeholder -->
        <div class="grid-card main-content">
            <div class="card-header">
                <div>
                    <h3 class="card-title">Platform Activity</h3>
                    <p class="card-subtitle">User engagement over the last 7 days</p>
                </div>
                <div class="card-actions">
                    <span class="badge-dot">Live</span>
                </div>
            </div>
            <div class="activity-chart">
                <div class="chart-bars">
                    <div class="chart-bar-wrapper">
                        <div class="chart-bar" style="height: 65%"></div>
                    </div>
                    <div class="chart-bar-wrapper">
                        <div class="chart-bar" style="height: 45%"></div>
                    </div>
                    <div class="chart-bar-wrapper">
                        <div class="chart-bar" style="height: 80%"></div>
                    </div>
                    <div class="chart-bar-wrapper">
                        <div class="chart-bar" style="height: 35%"></div>
                    </div>
                    <div class="chart-bar-wrapper">
                        <div class="chart-bar" style="height: 55%"></div>
                    </div>
                    <div class="chart-bar-wrapper">
                        <div class="chart-bar" style="height: 90%"></div>
                    </div>
                    <div class="chart-bar-wrapper">
                        <div class="chart-bar" style="height: 75%"></div>
                    </div>
                </div>
                <div class="chart-labels">
                    <span>Mon</span><span>Tue</span><span>Wed</span><span>Thu</span><span>Fri</span><span>Sat</span><span>Sun</span>
                </div>
            </div>
        </div>

        <!-- Reported Users Section -->
        <div class="grid-card secondary-content" *ngIf="dataService.dashboardStats() as stats">
            <div class="card-header">
                <h3 class="card-title">Recent Alerts</h3>
                <button class="view-all-btn" routerLink="/dashboard/reports">View All</button>
            </div>
            <div class="reported-users-list">
                <div *ngFor="let user of stats.mostReportedUsers" class="reported-user-item">
                    <div class="user-main">
                        <div class="user-avatar"
                            [style.background-image]="'url(' + (user.avatar || 'assets/default-avatar.png') + ')'">
                        </div>
                        <div class="user-info">
                            <p class="user-name">{{ user.name }}</p>
                            <span class="report-badge">{{ user.reportCount }} Reports</span>
                        </div>
                    </div>
                    <div class="user-actions">
                        <button class="action-btn" routerLink="/dashboard/reports">
                            <span class="material-symbols-outlined">chevron_right</span>
                        </button>
                    </div>
                </div>
                <app-db-feedback *ngIf="stats.mostReportedUsers.length === 0" type="empty" icon="sentiment_satisfied"
                    iconColor="var(--success)" title="All clear" message="No critical alerts at the moment.">
                </app-db-feedback>
            </div>
        </div>
    </div>

    <app-db-feedback *ngIf="isLoading()" type="loading"></app-db-feedback>
</div>